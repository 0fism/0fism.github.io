
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Driver SQL - Hexo</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="TriDiamond Obsidian,"> 
    <meta name="description" content="Creating a SQL Q&amp;amp;A System using phpMyAdmin and SQL SyntaxAs a passionate developer with experti,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Hexo" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.7.2/animate.min.css">

    
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/codemirror.min.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

    
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">

    
    <script>var musiclist = ""</script>
    
<script src="/js/loadaplayer.js"></script>

    <!-- 引用依赖 -->
    
<link rel="stylesheet" href="/aplayer/dist/APlayer.min.css">

    
<script src="/aplayer/dist/APlayer.min.js"></script>
<script src="/js/Meting.min.js"></script>

    
<meta name="generator" content="Hexo 7.0.0"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Hexo</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="http://example.com">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">Driver SQL</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url('/img/cover.jpg') ">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/Database"><b>「
                    </b>DATABASE<b> 」</b></a>
                
                January 13, 2024
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2024/01/13/driver-sql/" title="Driver SQL" class="">Driver SQL</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>Words count</i>
                    34k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>Reading time</i>
                    31 mins.
                </span>
                
                
                
                <span id="busuanzi_container_page_pv">
                    <b class="iconfont icon-read"></b> <i>Read count</i>
                    <span id="busuanzi_value_page_pv">0</span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/SQL-Statement/" rel="tag">SQL Statement</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/phpMyAdmin/" rel="tag">phpMyAdmin</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <h1 id="Creating-a-SQL-Q-A-System-using-phpMyAdmin-and-SQL-Syntax"><a href="#Creating-a-SQL-Q-A-System-using-phpMyAdmin-and-SQL-Syntax" class="headerlink" title="Creating a SQL Q&amp;A System using phpMyAdmin and SQL Syntax"></a>Creating a SQL Q&amp;A System using phpMyAdmin and SQL Syntax</h1><p>As a passionate developer with expertise in <strong>database management</strong>, I took on the exciting challenge of building a <strong>SQL Q&amp;A system</strong>. Leveraging the power of <strong>phpMyAdmin</strong> and my proficiency in <strong>SQL syntax</strong>, I successfully developed a robust solution that provided insightful answers to a set of predefined questions.</p>
<p>The SQL Q&amp;A system was designed to extract valuable information from a given dataset. One of the main objectives was to provide comprehensive insights about completed trips, driver cancellations, gross bookings, active drivers, average trip distance, and new drivers. To achieve this, I formulated a complex query that aggregated the necessary data and generated a <strong>weekly report</strong>. The result was a concise and informative overview of the key metrics for the specified timeframe.</p>
<p>In addition to the <strong>weekly report</strong>, the SQL Q&amp;A system also incorporated advanced functionalities. I implemented a query that calculated the total completed trips in the past 7 days and grouped them by <strong>18-district</strong>, utilizing the <code>uber.geofence</code> table for accurate geographical information. This feature allowed for a granular analysis of trip distribution across different districts.</p>
<p>Building upon the previous query, I further enhanced the system by incorporating a <strong>trip percentage breakdown</strong> for each district. By extending the SQL statement, I was able to calculate the percentage of total trips contributed by each district, providing valuable insights into the distribution of trips across the city.</p>
<p>Furthermore, the SQL Q&amp;A system featured a comprehensive <strong>driver profile query</strong>. This query retrieved individual driver details such as driver ID, age, app rating, past 3 months earnings per supply hour, and past 2 weeks acceptance rate. This information allowed for a detailed evaluation of driver performance, enabling data-driven decision-making when it came to driver management and incentives.</p>
<p>The creation of this SQL Q&amp;A system demonstrated not only my proficiency in SQL syntax and database management but also my ability to develop innovative solutions to complex problems. By leveraging the power of <strong>phpMyAdmin</strong> and my expertise in SQL, I successfully built a system that provided valuable insights and answered key questions about the dataset at hand. This project showcases my dedication to delivering efficient and effective solutions in the realm of data analysis and database management.</p>
<p><img src="/img/driver-table.png" alt="Uber table" title="MarineGEO logo"></p>
<p><img src="/img/sql-driver-simulation-table.png" alt="Uber table" title="MarineGEO logo"></p>
<h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><h3 id="With-the-data-table-shown-above"><a href="#With-the-data-table-shown-above" class="headerlink" title="With the data table shown above,"></a>With the data table shown above,</h3><ul>
<li>1 Write a query to show WEEKLY number of completed trips, number of driver canceled<br>trips, total gross booking (i.e. rider fare), number of active drivers (i.e. completed at least<br>one trip), average trip distance, number of new drivers.</li>
<li>2 Write a query to show the total completed trips in the past 7 days and group by<br>18-district. (You will need to use the table: uber.geofence)</li>
<li>3 On top of Q2, write a query to show the trip percentage by each district.</li>
<li>4 Write a query to show all individual driver’s profile:<br>driver_id, age, app rating, past 3 months earnings per supply hour and past 2 weeks<br>acceptance rate (i.e. accepts &#x2F; dispatches).</li>
</ul>
<h3 id="Answer-1"><a href="#Answer-1" class="headerlink" title="Answer 1"></a>Answer 1</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    weeks.Weekly,</span><br><span class="line">    c1.CompletedTrip,</span><br><span class="line">    c2.CanceledTrip,</span><br><span class="line">    c3.GrossBooking,</span><br><span class="line">    c4.ActiveDriver,</span><br><span class="line">    c5.AvgDistance,</span><br><span class="line">    c6.NewDriver</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="keyword">DISTINCT</span> WEEK(request_timestamp) <span class="keyword">AS</span> Weekly</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">UNION</span></span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="keyword">DISTINCT</span> WEEK(first_trip_date) <span class="keyword">AS</span> Weekly</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver</span><br><span class="line">    ) <span class="keyword">AS</span> weeks</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> CompletedTrip,</span><br><span class="line">            WEEK(request_timestamp) <span class="keyword">AS</span> <span class="keyword">Period</span></span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            trip_status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            <span class="keyword">Period</span></span><br><span class="line">    ) <span class="keyword">AS</span> c1 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c1.Period</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> CanceledTrip,</span><br><span class="line">            WEEK(request_timestamp) <span class="keyword">AS</span> <span class="keyword">Period</span></span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            trip_status <span class="operator">=</span> <span class="string">&#x27;driver_canceled&#x27;</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            <span class="keyword">Period</span></span><br><span class="line">    ) <span class="keyword">AS</span> c2 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c2.Period</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            ROUND(<span class="built_in">SUM</span>(rider_fare), <span class="number">1</span>) <span class="keyword">As</span> GrossBooking,</span><br><span class="line">            WEEK(request_timestamp) <span class="keyword">AS</span> <span class="keyword">Period</span></span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            <span class="keyword">Period</span></span><br><span class="line">    ) <span class="keyword">AS</span> c3 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c3.Period</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> ActiveDriver,</span><br><span class="line">            WEEK(first_trip_date) <span class="keyword">AS</span> TripPeriod</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            first_trip_date <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">            <span class="keyword">AND</span> is_rejected <span class="keyword">IS</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            TripPeriod</span><br><span class="line">    ) <span class="keyword">AS</span> c4 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c4.TripPeriod</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            ROUND(<span class="built_in">AVG</span>(trip_distance), <span class="number">1</span>) <span class="keyword">AS</span> AvgDistance,</span><br><span class="line">            WEEK(request_timestamp) <span class="keyword">AS</span> <span class="keyword">Period</span></span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            trip_distance <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            <span class="keyword">PERIOD</span></span><br><span class="line">    ) <span class="keyword">AS</span> c5 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c5.Period</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> NewDriver,</span><br><span class="line">            WEEK(first_trip_date) <span class="keyword">AS</span> TripPeriod</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            first_trip_date <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            TripPeriod</span><br><span class="line">    ) <span class="keyword">AS</span> c6 <span class="keyword">ON</span> weeks.Weekly <span class="operator">=</span> c6.TripPeriod</span><br></pre></td></tr></table></figure>



<h3 id="Answer-2"><a href="#Answer-2" class="headerlink" title="Answer 2"></a>Answer 2</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span></span><br><span class="line">    trips</span><br><span class="line"><span class="keyword">ADD</span></span><br><span class="line">    temp_location <span class="type">VARCHAR</span>(<span class="number">20</span>);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span></span><br><span class="line">    `trips`</span><br><span class="line"><span class="keyword">SET</span></span><br><span class="line">    `temp_location` <span class="operator">=</span> <span class="string">&#x27;Kowloon&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    `trips`.`trip_id` <span class="operator">=</span> <span class="string">&#x27;ub-iep-1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    geo.locations,</span><br><span class="line">    c1.CompletedOrder</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="keyword">DISTINCT</span> district <span class="keyword">AS</span> locations</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            geofence</span><br><span class="line">    ) <span class="keyword">AS</span> geo</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(temp_location) <span class="keyword">AS</span> CompletedOrder,</span><br><span class="line">            temp_location <span class="keyword">AS</span> Region</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            trip_status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span></span><br><span class="line">            <span class="keyword">AND</span> request_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">7</span> <span class="keyword">DAY</span>)</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            temp_location</span><br><span class="line">    ) <span class="keyword">AS</span> c1 <span class="keyword">ON</span> geo.locations <span class="operator">=</span> c1.Region;</span><br></pre></td></tr></table></figure>


<h3 id="Answer-3"><a href="#Answer-3" class="headerlink" title="Answer 3"></a>Answer 3</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    geo.locations,</span><br><span class="line">    c1.CompletedOrder,</span><br><span class="line">    ROUND(</span><br><span class="line">        c1.CompletedOrder <span class="operator">/</span>(</span><br><span class="line">            <span class="keyword">SELECT</span></span><br><span class="line">                <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">            <span class="keyword">FROM</span></span><br><span class="line">                trips</span><br><span class="line">        ) <span class="operator">*</span> <span class="number">100</span>,</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">    ) <span class="keyword">AS</span> percentage</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="keyword">DISTINCT</span> district <span class="keyword">AS</span> locations</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            geofence</span><br><span class="line">    ) <span class="keyword">AS</span> geo</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            <span class="built_in">COUNT</span>(temp_location) <span class="keyword">AS</span> CompletedOrder,</span><br><span class="line">            temp_location <span class="keyword">AS</span> Region</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            trip_status <span class="operator">=</span> <span class="string">&#x27;completed&#x27;</span></span><br><span class="line">            <span class="keyword">AND</span> request_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">7</span> <span class="keyword">DAY</span>)</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">            temp_location</span><br><span class="line">    ) <span class="keyword">AS</span> c1 <span class="keyword">ON</span> geo.locations <span class="operator">=</span> c1.Region;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span></span><br><span class="line">    trips <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> temp_location;</span><br></pre></td></tr></table></figure>


<h3 id="Answer-4"><a href="#Answer-4" class="headerlink" title="Answer 4"></a>Answer 4</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    driver.driver_id <span class="keyword">AS</span> DriverId,</span><br><span class="line">    <span class="built_in">FLOOR</span>(</span><br><span class="line">        DATEDIFF(</span><br><span class="line">            CURDATE(),</span><br><span class="line">            STR_TO_DATE(driver.date_of_birth, <span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">        ) <span class="operator">/</span> <span class="number">365</span></span><br><span class="line">    ) <span class="keyword">AS</span> Age,</span><br><span class="line">    driver.app_rating <span class="keyword">AS</span> AppRating,</span><br><span class="line">    c1.hours <span class="operator">/</span> c2.Earnings <span class="operator">*</span> <span class="number">100</span> <span class="keyword">AS</span> GainMoney,</span><br><span class="line">    c3.Accept <span class="operator">/</span> c5.Total <span class="operator">*</span> <span class="number">100</span> <span class="keyword">AS</span> AcceptRate,</span><br><span class="line">    c4.Dispatch <span class="operator">/</span> c5.Total <span class="operator">*</span> <span class="number">100</span> <span class="keyword">AS</span> DispatchRate</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    driver</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            driver_id,</span><br><span class="line">            (</span><br><span class="line">                TIMESTAMPDIFF(<span class="keyword">MINUTE</span>, start_timestamp, end_timestamp) <span class="operator">/</span> <span class="number">60</span></span><br><span class="line">            ) <span class="keyword">AS</span> hours</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver_supply</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            status <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string">&#x27;offline&#x27;</span>)</span><br><span class="line">            <span class="keyword">AND</span> start_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">3</span> <span class="keyword">MONTH</span>)</span><br><span class="line">    ) <span class="keyword">AS</span> c1 <span class="keyword">ON</span> driver.driver_id <span class="operator">=</span> c1.driver_id</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            driver_id,</span><br><span class="line">            <span class="built_in">SUM</span>(driver_earnings) <span class="keyword">AS</span> Earnings</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            trips</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            request_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">3</span> <span class="keyword">MONTH</span>)</span><br><span class="line">    ) <span class="keyword">AS</span> c2 <span class="keyword">ON</span> driver.driver_id <span class="operator">=</span> c2.driver_id</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            driver_id,</span><br><span class="line">            <span class="built_in">SUM</span>(accepts) <span class="keyword">AS</span> Accept</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver_supply</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            start_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">2</span> WEEK)</span><br><span class="line">    ) <span class="keyword">AS</span> c3 <span class="keyword">ON</span> driver.driver_id <span class="operator">=</span> c3.driver_id</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            driver_id,</span><br><span class="line">            <span class="built_in">SUM</span>(dispatches) <span class="keyword">AS</span> Dispatch</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver_supply</span><br><span class="line">        <span class="keyword">WHERE</span></span><br><span class="line">            start_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">2</span> WEEK)</span><br><span class="line">    ) <span class="keyword">AS</span> c4 <span class="keyword">ON</span> driver.driver_id <span class="operator">=</span> c4.driver_id</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            driver_id,</span><br><span class="line">            (</span><br><span class="line">                (</span><br><span class="line">                    <span class="keyword">SELECT</span></span><br><span class="line">                        <span class="built_in">SUM</span>(accepts)</span><br><span class="line">                    <span class="keyword">FROM</span></span><br><span class="line">                        driver_supply</span><br><span class="line">                    <span class="keyword">WHERE</span></span><br><span class="line">                        start_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">2</span> WEEK)</span><br><span class="line">                ) <span class="operator">+</span> (</span><br><span class="line">                    <span class="keyword">SELECT</span></span><br><span class="line">                        <span class="built_in">SUM</span>(dispatches)</span><br><span class="line">                    <span class="keyword">FROM</span></span><br><span class="line">                        driver_supply</span><br><span class="line">                    <span class="keyword">WHERE</span></span><br><span class="line">                        start_timestamp <span class="operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="type">INTERVAL</span> <span class="number">2</span> WEEK)</span><br><span class="line">                )</span><br><span class="line">            ) <span class="keyword">AS</span> Total</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            driver_supply</span><br><span class="line">    ) <span class="keyword">AS</span> c5 <span class="keyword">ON</span> driver.driver_id <span class="operator">=</span> c5.driver_id;</span><br></pre></td></tr></table></figure>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/chengdu.mp3'></li>
                
                    
            </ul>
            
                        
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d=''
        data-p='https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token'
    >Comments</div>


            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="https://s2.ax1x.com/2019/09/19/nLtSiD.png" height=300 width=300></img>
                    <p>John Doe</p>
                    <span>Think like an artist, develop like an artisan</span>
                    <dl>
                        
                            
                            
                            
                        
                        
                    </dl>
                </div>
                <ul>
                    <li><a href="/">6 <p>Articles</p></a></li>
                    <li><a href="/categories">6 <p>Categories</p></a></li>
                    <li><a href="/tags">13 <p>Tags</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>Contents</h4>
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Creating-a-SQL-Q-A-System-using-phpMyAdmin-and-SQL-Syntax"><span class="toc-number">1.</span> <span class="toc-text">Creating a SQL Q&amp;A System using phpMyAdmin and SQL Syntax</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Question"><span class="toc-number">1.1.</span> <span class="toc-text">Question</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#With-the-data-table-shown-above"><span class="toc-number">1.1.1.</span> <span class="toc-text">With the data table shown above,</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Answer-1"><span class="toc-number">1.1.2.</span> <span class="toc-text">Answer 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Answer-2"><span class="toc-number">1.1.3.</span> <span class="toc-text">Answer 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Answer-3"><span class="toc-number">1.1.4.</span> <span class="toc-text">Answer 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Answer-4"><span class="toc-number">1.1.5.</span> <span class="toc-text">Answer 4</span></a></li></ol></li></ol></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p class="copyright" id="copyright">
        &copy; 2024
        <span class="gradient-text">
            John Doe
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.9.4" target="_blank" rel="noopener">v1.4.9.4</a></small>
        
        </br>
        
        <span class="gradient-text">
            <a href="https://beian.miit.gov.cn/" title="beian.miit.gov.cn" target="_blank" rel="noopener">beian.miit.gov.cn</a>
        </span>
        
        
        </br>
        <span style="display: inline-block;"> <img src=/null></span>
        
        <span class="gradient-text">
            <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44010602009049" title="www.beian.gov.cn&#x2F;portal&#x2F;registerSystemInfo?recordcode&#x3D;44010602009049" target="_blank" rel="noopener">www.beian.gov.cn&#x2F;portal&#x2F;registerSystemInfo?recordcode&#x3D;44010602009049</a>
        </span>
        
    </p>
</footer>

<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>


 
<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.css">
 
<script src="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
  
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>
 
<script src="//cdn.bootcss.com/typed.js/2.0.10/typed.min.js"></script>
 
<script src="//cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script>
 
<script src="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>


<script src="https://cdn.bootcss.com/codemirror/5.48.4/codemirror.min.js"></script>
 
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/css/css.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/xml/xml.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/clike/clike.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/php/php.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/shell/shell.min.js"></script>
  
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/python/python.min.js"></script>
   
<script src="/js/busuanzi.min.js"></script>

<script>
  $(document).ready(function () {
    if ($('span[id^="busuanzi_"]').length) {
      initialBusuanzi();
    }
  });
</script>
 
<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/default-skin/default-skin.min.css">


<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
  

<script>
  function initialTyped() {
    var typedTextEl = $('.typed-text');
    if (typedTextEl && typedTextEl.length > 0) {
      var typed = new Typed('.typed-text', {
        strings: ['Think like an artist, develop like an artisan', '艺术家思维去思考问题，工匠创造精神去开发'],
        typeSpeed: 90,
        loop: true,
        loopCount: Infinity,
        backSpeed: 20,
      });
    }
  }

  if ($('.article-header') && $('.article-header').length) {
    $(document).ready(function () {
      initialTyped();
    });
  }
</script>




<!-- 引用依赖 -->
<script>document.write(aplayerconf)</script>




</html>
